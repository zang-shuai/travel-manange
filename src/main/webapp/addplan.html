<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>

</head>
<body>
<form id="guiderform" method="post">
    <div id="tour">
        <label>
            选择景点：
        </label><br>

    </div>
    <label>
        开始日期：
        <input id="startTime" name="pstartdate" type="date">
    </label><br>
    <label>
        结束日期：
        <input id="endTime" name="penddate" type="date">
    </label><br>
    <label>
        价格：
        <input name="pprice" type="number">
    </label><br>
    <label>
        最大游客数：
        <input name="pmaxcount" type="number">
    </label><br>


    点击查看导游：
    <div id="guider"></div>
<!--    <button type="button" onclick="refresh()">刷新</button>-->


    <input type="submit">
</form>

<script>
    const pathname = window.document.location.pathname;
    const pa = pathname.substring(0, pathname.substr(1).indexOf('/') + 1);
    document.getElementById("guiderform").setAttribute("action", pa + "/addGuiderServlet");

    //查看导游数目
    function refresh() {
        let endTime = document.getElementById("endTime").toString()
        let startTime = document.getElementById("startTime").toString()
        var xmlhttp = new XMLHttpRequest();
        xmlhttp.open("POST", "findFreeGuiderServlet?" + "startTime =" + startTime + "&endTime =" + endTime, true);
        xmlhttp.send();
        xmlhttp.onreadystatechange = function () {
            if (xmlhttp.readyState === 4 && xmlhttp.status === 200) {
                let responseText = xmlhttp.responseText
                alert(responseText)
            }
        }
    }


    let xmlhttp1 = new XMLHttpRequest();
    // xmlhttp1.open("POST", "findFreeGuiderServlet?" + "startTime =" + startTime + "&endTime =" + endTime, true);
    xmlhttp1.open("POST", "findFreeGuiderServlet" , true);
    xmlhttp1.send();
    xmlhttp1.onreadystatechange = function () {
        if (xmlhttp1.readyState === 4 && xmlhttp1.status === 200) {
            let responseText = xmlhttp1.responseText
            let elementById = document.getElementById("guider");
            let arr = JSON.parse(responseText);
            // elementById.innerHTML=responseText
            console.log(arr)
        }
    }













    //获取所有旅游景点
    var xmlhttp = new XMLHttpRequest();
    xmlhttp.open("POST", "findAllTouristServlet", true);
    xmlhttp.send();
    xmlhttp.onreadystatechange = function () {
        if (xmlhttp.readyState === 4 && xmlhttp.status === 200) {
            let tour = document.getElementById("tour")
            let responseText = xmlhttp.responseText
            let arr = JSON.parse(responseText);
            for (let obj in arr) {
                let input = document.createElement("input")
                let span = document.createElement("span")
                input.type = "radio"
                input.name = "tourist"
                let arrElement = arr[obj]
                input.value = arrElement["tname"]
                span.innerHTML = arrElement["tname"]
                tour.appendChild(input)
                tour.appendChild(span)
            }
        }
    }


</script>
</body>
</html>